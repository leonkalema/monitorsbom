# CVE Triage Worksheet — ECU Vulnerability Assessment

**Product:** [Your ECU Name]  
**SBOM Version:** mbedtls.cdx.json  
**Triage Date:** 2026-01-22  
**Triage Owner:** [Your Name]  

---

## Configuration Inputs (FILL THESE FIRST)

### mbedTLS Build Configuration
| Config Option | Value | Notes |
|---------------|-------|-------|
| `MBEDTLS_SSL_PROTO_DTLS` | YES / NO | DTLS protocol support |
| `MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE` | YES / NO | Affects CVE-2022-35409 |
| `MBEDTLS_SSL_DTLS_CONNECTION_ID` | YES / NO | Affects CVE-2022-46393 |
| `MBEDTLS_SSL_CID_IN_LEN_MAX` | [value] | If > 2*OUT_LEN_MAX, vulnerable |
| `MBEDTLS_SSL_CID_OUT_LEN_MAX` | [value] | |
| `MBEDTLS_SSL_IN_CONTENT_LEN` | [value] | If < 258, affects CVE-2022-35409 |
| `MBEDTLS_SSL_PROTO_TLS1_3` | YES / NO | Affects CVE-2024-45159 |
| `MBEDTLS_PSA_CRYPTO_C` | YES / NO | PSA subsystem |
| `MBEDTLS_CTR_DRBG_C` | YES / NO | RNG selection |
| `MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG` | YES / NO | External RNG |
| LMS signatures used? | YES / NO | Affects CVE-2025-49600, CVE-2025-49601 |
| Hardware hash accelerator? | YES / NO | Affects CVE-2025-49600 |

### ECU Network Exposure
| Interface | Present | External Access | Auth Required |
|-----------|---------|-----------------|---------------|
| CAN / CAN-FD | YES / NO | YES / NO | N/A |
| Ethernet (DoIP) | YES / NO | YES / NO | YES / NO |
| OTA Channel | YES / NO | YES / NO | YES / NO |
| Debug Port | YES / NO | YES / NO | YES / NO |

### Shibboleth Usage
| Question | Answer |
|----------|--------|
| Where is Shibboleth used? | ECU / Backend / Not Used |
| ODBC replay cache configured? | YES / NO |
| Windows deployment? | YES / NO |

---

## CVE Triage Results

### Legend
- **Status:** NOT_AFFECTED / AFFECTED / EXPLOITABLE / MITIGATED / ACCEPTED
- **Exploitability:** NONE / LOW / MEDIUM / HIGH / CRITICAL
- **Action:** PATCH / COMPENSATING_CONTROL / ACCEPT_RISK / NO_ACTION

---

## mbedTLS CVEs

### CVE-2021-44732 (CRITICAL, CVSS 9.8)
**Description:** Double free in OOM conditions via `mbedtls_ssl_set_session()` failure

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| Vulnerable code compiled? | YES / NO | Check if SSL session functions used |
| Feature enabled at runtime? | YES / NO | Is session resumption used? |
| Attack vector reachable? | YES / NO | Can attacker trigger OOM on ECU? |
| Harm in ECU context? | YES / NO | Memory corruption → potential RCE |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2022-35409 (CRITICAL, CVSS 9.1)
**Description:** DTLS heap buffer over-read via invalid ClientHello (up to 255 bytes)

**Preconditions:**
- `MBEDTLS_SSL_DTLS_CLIENT_PORT_REUSE` enabled AND
- `MBEDTLS_SSL_IN_CONTENT_LEN` < 258 (with default cookie check)

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| DTLS compiled in? | YES / NO | |
| Port reuse enabled? | YES / NO | Check config |
| IN_CONTENT_LEN < 258? | YES / NO | Check config |
| DTLS server exposed? | YES / NO | Can attacker send ClientHello? |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2022-46393 (CRITICAL, CVSS 9.8)
**Description:** DTLS heap overflow/over-read with Connection ID

**Preconditions:**
- `MBEDTLS_SSL_DTLS_CONNECTION_ID` enabled AND
- `MBEDTLS_SSL_CID_IN_LEN_MAX` > 2 * `MBEDTLS_SSL_CID_OUT_LEN_MAX`

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| DTLS Connection ID enabled? | YES / NO | |
| CID_IN > 2*CID_OUT? | YES / NO | Check values |
| DTLS exposed to attacker? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2024-45158 (CRITICAL, CVSS 9.8)
**Description:** Stack buffer overflow in `mbedtls_ecdsa_der_to_raw()` / `mbedtls_ecdsa_raw_to_der()`

**Preconditions:**
- Application calls these functions directly with `bits` > largest supported curve
- OR PSA disabled and any `bits` value

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| App calls these functions directly? | YES / NO | Check application code |
| PSA enabled? | YES / NO | If NO, more vulnerable |
| Untrusted input to bits param? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2024-45159 (CRITICAL, CVSS 9.8)
**Description:** TLS 1.3 client cert verification bypass (keyUsage/extKeyUsage not checked)

**Preconditions:**
- TLS 1.3 enabled AND
- Server with **optional** client authentication (not required)

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| TLS 1.3 enabled? | YES / NO | |
| ECU acts as TLS server? | YES / NO | |
| Optional client auth used? | YES / NO | If required auth, not vulnerable |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-47917 (HIGH, CVSS 8.9)
**Description:** Use-after-free in `mbedtls_x509_string_to_names()` with multiple DNs

**Preconditions:**
- Application uses `mbedtls_x509_string_to_names()` directly
- SAN string contains more than one DN

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| App calls this function? | YES / NO | Check cert generation code |
| Multiple DNs in SAN? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2024-23775 (HIGH, CVSS 7.5)
**Description:** Integer overflow in `mbedtls_x509_set_extension()` causing DoS

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| X.509 extension setting used? | YES / NO | |
| Attacker-controlled input? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2023-52353 (HIGH, CVSS 7.5)
**Description:** TLS version downgrade after `mbedtls_ssl_session_reset()`

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| Session reset used? | YES / NO | |
| TLS 1.3 → 1.2 downgrade harmful? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2021-36647 (MEDIUM, CVSS 4.7)
**Description:** RSA timing side-channel in `mbedtls_mpi_exp_mod()` (SGX/TrustZone risk)

**Preconditions:**
- Attacker has precise timing + memory access (e.g., untrusted OS attacking secure enclave)

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| RSA used? | YES / NO | |
| Running in secure enclave? | YES / NO | TrustZone, SGX, etc. |
| Untrusted code on same platform? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-27809 (MEDIUM, CVSS 5.4)
**Description:** Client accepts certs for wrong hostname if `mbedtls_ssl_set_hostname()` not called

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| ECU is TLS client? | YES / NO | |
| `set_hostname()` called? | YES / NO | Check code |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2024-28755 (MEDIUM, CVSS 6.5)
**Description:** TLS 1.3 downgrade after session reset (3.5.x specific)

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| Using mbedTLS 3.5.x? | YES / NO | You're on 2.28.1 |

**Triage Decision:**
- Status: `NOT_AFFECTED` (wrong version branch)
- Notes: This CVE is for 3.5.x only, you're on 2.28.x

---

### CVE-2024-45157 (MEDIUM, CVSS 5.1)
**Description:** HMAC_DRBG not used even when configured

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| HMAC_DRBG required for compliance? | YES / NO | |
| PSA_HMAC_DRBG_MD_TYPE set? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-49600 (MEDIUM, CVSS 4.9)
**Description:** LMS signature forgery via fault injection on hardware hash accelerator

**Preconditions:**
- LMS (post-quantum) signatures used AND
- Hardware hash accelerator AND
- Attacker can perform fault injection

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| LMS signatures used? | YES / NO | Post-quantum, rare |
| HW hash accelerator? | YES / NO | |
| Fault injection possible? | YES / NO | Physical access required |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-49601 (MEDIUM, CVSS 4.8)
**Description:** OOB read in LMS public key import with truncated input

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| LMS public key import used? | YES / NO | |
| Untrusted key input? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-52497 (MEDIUM, CVSS 4.8)
**Description:** PEM parsing heap buffer underflow

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| PEM parsing used? | YES / NO | |
| Untrusted PEM input? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-48965 (MEDIUM, CVSS 4.0)
**Description:** NULL pointer dereference in ASN.1 named data

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| ASN.1 named data functions used? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2025-54764 (MEDIUM, CVSS 6.2)
**Description:** Local timing attack on RSA, `mbedtls_mpi_mod_inv`, `mbedtls_mpi_gcd`

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| RSA used? | YES / NO | |
| Local attacker possible? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

## Shibboleth SP CVEs

### CVE-2025-9943 (CRITICAL, CVSS 9.1)
**Description:** SQL injection in SAML response ID when using ODBC replay cache

**Preconditions:**
- Shibboleth SP used AND
- ODBC plugin for replay cache AND
- SQL database backend

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| Shibboleth used on ECU? | YES / NO | Usually backend only |
| ODBC replay cache? | YES / NO | |

**Triage Decision:**
- Status: `_______________`
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

### CVE-2023-22947 (HIGH, CVSS 7.3)
**Description:** DLL planting privilege escalation (Windows only)

**Preconditions:**
- Windows deployment AND
- Default install path (C:\opt)

| Triage Question | Answer | Rationale |
|-----------------|--------|-----------|
| Windows deployment? | YES / NO | ECUs rarely run Windows |
| Default install path? | YES / NO | |

**Triage Decision:**
- Status: `_______________` (likely NOT_AFFECTED if Linux/RTOS)
- Exploitability: `_______________`
- Action: `_______________`
- Owner: `_______________`
- Notes: `_______________`

---

## Triage Summary

| Status | Count | CVE IDs |
|--------|-------|---------|
| NOT_AFFECTED | | |
| AFFECTED (patch required) | | |
| EXPLOITABLE (urgent) | | |
| ACCEPTED (with rationale) | | |
| MITIGATED (compensating control) | | |

---

## Sign-Off

| Role | Name | Date | Signature |
|------|------|------|-----------|
| Triage Lead | | | |
| Security Architect | | | |
| Product Owner | | | |

---

## Appendix: How to Find mbedTLS Config

```bash
# If you have the mbedTLS source:
grep -E "^#define MBEDTLS_" include/mbedtls/mbedtls_config.h

# Or check your project's config override:
find . -name "*config*.h" | xargs grep MBEDTLS_SSL_DTLS
```

## Appendix: Remediation Versions

| Component | Current | Fixed Version | Notes |
|-----------|---------|---------------|-------|
| mbedTLS | 2.28.1 | **2.28.10** | LTS branch |
| mbedTLS | 2.28.1 | **3.6.5** | Latest stable |
| Shibboleth SP | 3.4.1 | **3.5.1+** | |
